import json

def search_in_hashes(search_hash, hashed_data_dict):
    matched_dlls = [dll for dll, hashes in hashed_data_dict.items() if search_hash in hashes.values()]

    if matched_dlls:
        matched_algo = [algo for dll, hashes in hashed_data_dict.items() for algo, hash_val in hashes.items() if hash_val == search_hash][0]
        print(f"The provided hash '{search_hash}' matches the hash for {matched_dlls} generated by the algorithm: {matched_algo}")
    else:
        print(f"The provided hash '{search_hash}' does not match any hash of the listed DLLs.")

def main():
    with open('hashed_data.json', 'r') as f:
        hashed_data_dict = json.load(f)

    search_hash = input("\nEnter an encrypted string to search for: ")
    search_in_hashes(search_hash, hashed_data_dict)

if __name__ == '__main__':
    main()
